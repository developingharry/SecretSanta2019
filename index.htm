<!DOCTYPE html>
<html lang="en">

<head>
    <title>Secret Santa Maker</title>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/main.css">
    <link href="https://fonts.googleapis.com/css?family=Aleo" rel="stylesheet">
    <!-- font for public results -->
    <link href="https://fonts.googleapis.com/css?family=Just+Me+Again+Down+Here" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/themes/blitzer/jquery-ui.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script>
</head>

<body>
    <!-- shows main page if this isn't a bespoke URL sent to participants, otherwise shows "secret" page -->
    <span data-bind="visible: !secretData()" class="toplevel">
        <h1 class="pagetitle">Secret Santa Maker</h1>
        <table>
            <tr>
                <td>SANTAS</td>
            </tr>
            What's the budget?
            <input data-bind="textInput: ViewModel.santaBudget" /></p>
            <tbody data-bind="foreach: santas, afterAdd: arrayInitialised()">
                <tr>
                    <td>
                        <input data-bind="value: name, valueUpdate: 'keyup'" />
                        <img src="img/bin.png" width="15px" height="15px" alt="remove item" title="Remove this Santa" data-bind="click: $root.removeSanta">
                        <!-- error message line, to be shown if field has no content -->
                         <span data-bind='visible: name.hasError, text: name.validationMessage'></span>
                    </td>
                </tr>
            </tbody>
        </table>
        <button data-bind="click: addSanta">add another Santa</button>
        <br>

        <h3>How would you like this to be set up? See the results, or keep them super secret so you can join in too?</h3>
        <p>
            <input type="radio" name="resultsoptions" value="showResults" data-bind="checked: resultsOption" />Reveal the results<br>
            <input type="radio" name="resultsoptions" value="hideResults" data-bind="checked: resultsOption" />Hide the names
        </p>

        <!-- nb: the inline style & visibility data-bind is the best way I've found to preload DOM elements without flickering. -->

        <!-- ko if: santas().length > 1 && !anyErrors()-->
        <button style="display: none" data-bind="visible: true, click: assignGiftees">FINISHED</button>
        <!-- /ko -->

    </span>



    <!-- ko if: secretData() -->
    <div id="santaface" style="display: none" data-bind="visible:true">
        <hgroup class="speech-bubble">
            <h1>Hey <span data-bind="text: santaData()"></span>!</h1>
            <h2>Your secret santa target is <span data-bind="text: gifteeData()"></span>, and the budget is <span data-bind="text: showBudget()"></span>!</h2>
            <h2>Merry Xmas!</h2>
        </hgroup>
    </div>
    <!-- /ko -->


<!-- beginning of results dialog -->
<div id="showResultsDialog" style="display: none" data-bind="visible:true" title="Secret Santas:">
    <!-- ko if: resultsOption() == 'showResults' -->
    <span data-bind="foreach:santas">
        <span data-bind="text: name() + (' will be buying for ') + giftee()"></span><br>
    </span>
    <!-- /ko -->
    <!-- ko if: resultsOption() == 'hideResults' -->
    <span>Please give the following links to each giftee.  You can copy them to the clipboard just by clicking!</span>
    <span data-bind="foreach: santas">
        <p class="secretUrl" data-bind="attr: {id: $index},
                                            text:'Click here to copy ' + name() + '\'s link', 
                                            click: function(data, event) { copyUrl(secretUrl(), event) }">
        </p>
    </span>
    <!-- /ko -->
</div>
<!-- end of results dialog -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.2/knockout-min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
    <script src="js/app.js"></script>

</body>
</html>

<!-- Public Domain Santa Photo by bruce mars from Pexels -->
<!-- Main background Photo by rawpixel.com from Pexels -->
