<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/themes/blitzer/jquery-ui.css">
    <title>Secret Santa Maker</title>
  </head>
  <body>

    <!-- shows main page if this isn't a bespoke URL sent to participants, otherwise shows "secret" page -->
    <main data-bind="visible: !secretData()" class="container">
        <h1 class="pagetitle">Secret Santa Maker</h1>
        
        <section class="row">
            <div class="col lead instructions">
            To set up Secret Santa assignments for your office/apartment/club:<br>
            <ol>
                <li>Set a max spend (eg. Â£5): <input data-bind="textInput: ViewModel.santaBudget" size="9" /></li>
                <li>Decide if you're joining in (and want to keep the results secret, <b>even from you</b>), or if you're happy to see who got whom.<br>
                    <ol type="a">
                        <li>
                            <input type="radio" name="resultsoptions" value="showResults" data-bind="checked: resultsOption" />Reveal the results
                        </li>
                        <li>
                            <input type="radio" name="resultsoptions" value="hideResults" data-bind="checked: resultsOption" />Hide the names
                        </li>
                    </ol>
                </li>
                <li>Start adding Santas using the boxes on the right!  If you need to remove one, just click the little recycle bin.</li>
                <li>Once you have everyone's name entered, press FINISHED to see the results.</li>
            </ol>

            </div>

            <div class="col santaform" id="santaform">
                <p data-bind="foreach: santas">
                    <!-- <input data-bind="value: name, valueUpdate: 'keyup'" /> -->
                    <input data-bind="textInput : name, event: { keyup: enterCheck }, hasFocus: true" />
                    <img src="img/bin.png" width="15px" height="15px" alt="remove item" title="Remove this Santa" data-bind="click: $root.removeSanta">
                    <!-- error message line, to be shown if field has no content -->
                    <span data-bind='visible: name.hasError, text: name.validationMessage'></span>
                    <br>
                </p>
                <button data-bind="click: addSanta" id="addSantaButton">add another Santa</button>
                <!-- nb: the inline style & visibility data-bind is the best way I've found to preload DOM elements without flickering. -->
                <!-- ko if: santas().length > 1 && !anyErrors()-->
                <button style="display: none" data-bind="visible: true, click: assignGiftees">FINISHED</button>
                <!-- /ko -->
            </div>
        </section>

        <section class = "row">
            <footer class="col">
                <div>NB. It may please you to hear that NONE of your details (email, names etc) are stored by this website.  As soon as you've gone, I'll have forgotten who you are!  (don't take it personally, and don't worry, the site will still work!)</div>
            </footer>
        </section>
    </main>






    <!-- Pop-up contents, displayed dependent on radio button choice by user. -->
    <section id="showResultsDialog" style="display: none" data-bind="visible:true" title="Secret Santas:">
        <!-- ko if: resultsOption() == 'showResults' -->
        <span data-bind="foreach:santas">
            <span data-bind="text: name() + (' will be buying for ') + giftee()"></span><br>
        </span>
        <!-- /ko -->
        <!-- ko if: resultsOption() == 'hideResults' -->
        <span>Please give the following links to each giftee.  You can copy them to the clipboard just by clicking!</span>
        <span data-bind="foreach: santas">
            <p class="secretUrl" data-bind="attr: {id: $index},
                                                text:'Click here to copy ' + name() + '\'s link', 
                                                click: function(data, event) { copyUrl(secretUrl(), event) }">
            </p>
        </span>
        <!-- /ko -->
    </section>
    <!-- End of pop-up contents -->



    <!-- to be displayed if this is a user visiting the site from a secret link, sent by the original user. -->
    <!-- ko if: secretData() -->
    <section id="santaface" style="display: none" data-bind="visible:true">
        <hgroup class="speech-bubble">
            <h1>Hey <span data-bind="text: santaData()"></span>!</h1>
            <h2>Your secret santa target is <span data-bind="text: gifteeData()"></span>, and the budget is <span data-bind="text: showBudget()"></span>!</h2>
            <h2>Merry Xmas!</h2>
        </hgroup>
    </section>
    <!-- /ko -->

    <!-- js scripts -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.2/knockout-min.js"></script>
    <!-- jQueryUI for modals that play nicely with knockout -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- my main js -->
    <script src="js/app.js"></script>

  </body>
</html>

<!-- Public Domain Santa Photo by bruce mars from Pexels -->
<!-- Main background Photo by rawpixel.com from Pexels -->
